
#######################################
# No deployment for not-master pushes.
#######################################

version: 1.0.0-sr{build}
configuration: Release

environment:
  apiKey:
    secure: mD3FPCEX0G8fa8s9p33qiMKI6NnwOyXkkm9T74Y4Wl9K8IZuV8GLk6oMknWBCzm/

branches:
  except:
    - master

#init:
- ps: iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))

before_build:
  - nuget restore


build:
  parallel: true
  verbosity: minimal


artifacts:
  - path: '**\*.nupkg'


after_build:
  - ps: Write-Host $env:appveyor_build_version
  #- ps: '& ".\NuGet\NuGet Package and Package.ps1" -Version $env:appveyor_build_version -NuGet "C:\Tools\NuGet\nuget.exe" -feedSource https://www.myget.org/F/openrealestate/api/v2 -apiKey $env:apiKey'
  - ps: '& ".\NuGet\NuGet Package and Package.ps1" -Version 1.0.0-sr20 -NuGet "C:\Tools\NuGet\nuget.exe" -feedSource https://www.myget.org/F/openrealestate/api/v2 -apiKey 93b1057e-57a4-4971-95e9-7078eb1f45a0'
  

cache:
  - packages -> **\packages.config

#on_finish:
- ps: $blockRdp = $true; iex ((new-object net.webclient).DownloadString('https://raw.githubusercontent.com/appveyor/ci/master/scripts/enable-rdp.ps1'))